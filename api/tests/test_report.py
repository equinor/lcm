import unittest
from pathlib import Path

from config import Config
from controllers.report import create_report

request = {
    "fitness": 4.4,
    "curve": [
        24.760265984966853,
        24.760265984966853,
        24.760265984966853,
        24.760265984966853,
        24.760265984966853,
        24.760265984966853,
        24.760265984966853,
        24.760265984966853,
        24.66132013232447,
        24.405921000051023,
        24.405921000051023,
        24.405921000051023,
        24.405921000051023,
        24.405921000051023,
        24.263870398510857,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.157464646595628,
        23.14494941140656,
        22.79260349905688,
        22.76124725733934,
        22.76124725733934,
        22.70409513574823,
        22.70409513574823,
        22.70409513574823,
        22.70409513574823,
        22.70409513574823,
        22.70409513574823,
        22.03365351452154,
        22.03365351452154,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        22.0039560668872,
        21.936000287548488,
        21.371589345517165,
        21.05947717635218,
        21.05947717635218,
        19.968809996991478,
        19.968809996991478,
        19.968809996991478,
        19.968809996991478,
        19.968809996991478,
        19.968809996991478,
        19.968809996991478,
        19.968809996991478,
        19.968809996991478,
        19.968809996991478,
        19.968809996991478,
        19.968809996991478,
        19.70095921290463,
        19.67310843030912,
        19.67310843030912,
        19.67310843030912,
        19.67310843030912,
        19.67310843030912,
        19.67310843030912,
        19.67310843030912,
        19.67310843030912,
        19.67310843030912,
        19.569920974028108,
        19.569920974028108,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        19.424168524288945,
        18.834064835696655,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.815049522335027,
        18.80877678463467,
        17.67603549803516,
        17.67603549803516,
        17.67603549803516,
        17.67603549803516,
        17.67603549803516,
        17.67603549803516,
        17.669540861902142,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.339579565159493,
        16.337756146654282,
        16.337756146654282,
        15.929791913230055,
        15.929791913230055,
        14.868801445516398,
        14.868801445516398,
        14.868801445516398,
        14.868801445516398,
        14.868801445516398,
        14.868801445516398,
        14.868801445516398,
        14.868801445516398,
        14.868801445516398,
        14.868801445516398,
        14.868801445516398,
        14.868801445516398,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.867630817358892,
        14.860424440477974,
        14.539091423284532,
        14.539091423284532,
        14.539091423284532,
        14.437161475477517,
        14.437161475477517,
        14.437161475477517,
        14.437161475477517,
        14.437161475477517,
        14.437161475477517,
        14.168245320431206,
        14.168245320431206,
        14.168245320431206,
        14.168245320431206,
        14.168245320431206,
        14.168245320431206,
        14.168245320431206,
        14.168245320431206,
        14.168245320431206,
        14.168245320431206,
        13.846770027057604,
        13.846770027057604,
        13.846770027057604,
        13.442128212486182,
        13.442128212486182,
        13.442128212486182,
        13.442128212486182,
        13.442128212486182,
        13.442128212486182,
        13.442128212486182,
        12.854682185001785,
        12.854682185001785,
        12.269860280355859,
        12.269860280355859,
        12.269860280355859,
        12.269860280355859,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.649962921657089,
        11.616263088138906,
        11.616263088138906,
        11.616263088138906,
        11.145731745164484,
        11.145731745164484,
        11.145731745164484,
        11.145731745164484,
        11.145731745164484,
        11.145731745164484,
        11.145731745164484,
        11.145731745164484,
        11.145731745164484,
        11.145731745164484,
        10.634358227132175,
        10.634358227132175,
        10.396491622667979,
        10.396491622667979,
        10.396491622667979,
        10.396491622667979,
        10.396491622667979,
        10.396491622667979,
        10.396491622667979,
        10.396491622667979,
        10.396491622667979,
    ],
    "pillVolume": 10,
    "pillDensity": 350,
    "bridgingMode": "PERMEABILITY",
    "bridgingValue": 500,
    "weighting": {"bridge": 5, "cost": 5, "co2": 5, "environmental": 5},
    "products": {
        "b": {"id": "baracarb150", "value": 45, "percentage": 12},
        "c": {"id": "supercom", "value": 88, "percentage": 12},
        "d": {"id": "compound-V", "value": 77, "percentage": 12},
        "e": {"id": "tight-seal", "value": 5, "percentage": 12},
        "f": {"id": "tighterfit", "value": 6, "percentage": 12},
        "g": {"id": "Compund-B", "value": 56, "percentage": 12},
    },
    "totalMass": 3500,
}


class ReportTest(unittest.TestCase):
    @staticmethod
    def test_create_report():
        create_report(request, bridge=False)
        result = Path(f"{Config.HOME_DIR}/report.pdf")
        # Check if file was created
        assert result.is_file()
        # Check that file has a minimum size of 30KB
        assert result.stat().st_size > 30000
